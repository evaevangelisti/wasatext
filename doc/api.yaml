openapi: 3.0.3

info:
  title: WASAText
  version: 1.0.0
  description: Connect with your friends effortlessly using WASAText!

servers:
  - url: http://localhost:8080/v1

tags:
  - name: users
    description: Users related operations
  - name: conversations
    description: Conversations related operations

paths:
  /users:
    get:
      operationId: getUsers
      summary: Get users
      description: Gets a list of users optionally filtered by a search query
      tags:
        - users
      parameters:
        - name: q
          in: query
          required: false
          description: Search query to filter users by username
          schema:
            type: string
            minLength: 1
            maxLength: 16
            pattern: "^.*$"
            description: Search query
          example: Maria
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Users retrieved successfully
          content:
            application/json:
              schema:
                type: object
                description: List of users object
                properties:
                  users:
                    type: array
                    minItems: 0
                    maxItems: 100
                    description: List of users
                    items:
                      $ref: "#/components/schemas/User"
                required:
                  - users
              example:
                users:
                  - userId: "550e8400-e29b-41d4-a716-446655440000"
                    username: Maria
                    profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440000.jpg"
                    createdAt: "2023-10-01T12:00:00Z"
                  - userId: "550e8400-e29b-41d4-a716-446655440001"
                    username: John
                    profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440001.jpg"
                    createdAt: "2023-10-02T12:00:00Z"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"
    post:
      operationId: doLogin
      summary: Login
      description: Login or register a user
      tags:
        - users
      requestBody:
        description: User login information
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Username object
              properties:
                username:
                  $ref: "#/components/schemas/Username"
              required:
                - username
            example:
              username: Maria
      responses:
        "200":
          description: User logged in successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
              examples:
                userExample:
                  $ref: "#/components/examples/userExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /users/{userId}:
    get:
      operationId: getUser
      summary: Get user
      description: Gets a user by their unique identifier
      tags:
        - users
      parameters:
        - $ref: "#/components/parameters/userId"
      security:
        - BearerAuth: []
      responses:
        "200":
          description: User found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
              examples:
                userExample:
                  $ref: "#/components/examples/userExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /me/username:
    put:
      operationId: setMyUserName
      summary: Update username
      description: Update the username of the authenticated user
      tags:
        - users
      requestBody:
        description: User details
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Username object
              properties:
                username:
                  $ref: "#/components/schemas/Username"
              required:
                - username
            example:
              username: Maria
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Username updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
              examples:
                userExample:
                  $ref: "#/components/examples/userExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /me/photo:
    put:
      operationId: setMyPhoto
      summary: Update photo
      description: Update the profile picture of the authenticated user
      tags:
        - users
      requestBody:
        description: User details
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              description: Image object
              properties:
                image:
                  $ref: "#/components/schemas/Image"
              required:
                - image
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Profile picture updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
              examples:
                userExample:
                  $ref: "#/components/examples/userExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /conversations:
    get:
      operationId: getMyConversations
      summary: Get conversations
      description: Gets the conversations of the authenticated user
      tags:
        - conversations
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Conversations retrieved successfully
          content:
            application/json:
              schema:
                type: object
                description: List of conversations object
                properties:
                  conversations:
                    type: array
                    minItems: 0
                    maxItems: 100
                    description: List of conversations
                    items:
                      allOf:
                        - $ref: "#/components/schemas/ConversationWithoutMessages"
                        - type: object
                          description: Last message in the conversation
                          properties:
                            lastMessage:
                              $ref: "#/components/schemas/Message"
                required:
                  - conversations
              example:
                conversations:
                  - conversationId: "550e8400-e29b-41d4-a716-446655440000"
                    type: private
                    participants:
                      - userId: "550e8400-e29b-41d4-a716-446655440000"
                        username: Maria
                        profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440000.jpg"
                      - userId: "550e8400-e29b-41d4-a716-446655440001"
                        username: John
                        profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440001.jpg"
                    lastMessage:
                      messageId: "550e8400-e29b-41d4-a716-446655440000"
                      content: "Hello, how are you?"
                      isForwarded: false
                      sender:
                        userId: "550e8400-e29b-41d4-a716-446655440000"
                        username: Maria
                        profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440000.jpg"
                      status:
                        delivered:
                          "550e8400-e29b-41d4-a716-446655440001": "2023-10-01T12:00:00Z"
                        read:
                          "550e8400-e29b-41d4-a716-446655440001": "2023-10-01T12:05:00Z"
                      comments: []
                      sentAt: "2023-10-01T12:00:00Z"
                    createdAt: "2023-10-01T12:00:00Z"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"
    post:
      operationId: createConversation
      summary: Create conversation
      description: Creates a new conversation
      tags:
        - conversations
      requestBody:
        description: Conversation details
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Conversation object
              properties:
                type:
                  $ref: "#/components/schemas/Type"
              required:
                - type
              oneOf:
                - type: object
                  description: Private conversation
                  properties:
                    participants:
                      type: array
                      minItems: 2
                      maxItems: 2
                      description: List of participants in a private conversation
                      items:
                        $ref: "#/components/schemas/Id"
                  required:
                    - participants
                - type: object
                  description: Group conversation
                  properties:
                    name:
                      $ref: "#/components/schemas/Name"
                    participants:
                      type: array
                      minItems: 1
                      maxItems: 100
                      description: List of group members
                      items:
                        $ref: "#/components/schemas/Id"
                  required:
                    - name
                    - participants
              discriminator:
                propertyName: type
      security:
        - BearerAuth: []
      responses:
        "201":
          description: Conversation created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Conversation"
              examples:
                conversationExample:
                  $ref: "#/components/examples/conversationExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /conversations/{conversationId}:
    get:
      operationId: getConversation
      summary: Get conversation
      description: Gets a conversation by its unique identifier
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/conversationId"
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Conversation found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Conversation"
              examples:
                conversationExample:
                  $ref: "#/components/examples/conversationExample"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /conversations/{conversationId}/messages:
    post:
      operationId: sendMessage
      summary: Send message
      description: Sends a message to a conversation
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/conversationId"
      requestBody:
        description: Message details
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              description: Message object
              properties:
                content:
                  $ref: "#/components/schemas/Content"
                image:
                  $ref: "#/components/schemas/Image"
              required:
                - content
            example:
              content: Hello, how are you?
      security:
        - BearerAuth: []
      responses:
        "201":
          description: Message sent successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
              examples:
                messageExample:
                  $ref: "#/components/examples/messageExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /conversations/{conversationId}/forwards:
    post:
      operationId: forwardMessage
      summary: Forward message
      description: Forwards a message to a conversation
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/conversationId"
      requestBody:
        description: Message details
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Forwarded message object
              properties:
                messageId:
                  $ref: "#/components/schemas/Id"
              required:
                - messageId
            example:
              messageId: "550e8400-e29b-41d4-a716-446655440000"
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Message forwarded successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
              examples:
                messageExample:
                  $ref: "#/components/examples/messageExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /groups/{conversationId}/name:
    put:
      operationId: setGroupName
      summary: Update group name
      description: Update the name of a group
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/conversationId"
      requestBody:
        description: Group details
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Group name object
              properties:
                name:
                  $ref: "#/components/schemas/Name"
              required:
                - name
            example:
              name: Friends Chat
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Group name updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GroupConversation"
              examples:
                groupConversationExample:
                  $ref: "#/components/examples/groupConversationExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /groups/{conversationId}/photo:
    put:
      operationId: setGroupPhoto
      summary: Update group photo
      description: Update the photo of a group
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/conversationId"
      requestBody:
        description: Group details
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              description: Image object
              properties:
                image:
                  $ref: "#/components/schemas/Image"
              required:
                - image
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Group photo updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GroupConversation"
              examples:
                groupConversationExample:
                  $ref: "#/components/examples/groupConversationExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /groups/{conversationId}/members:
    post:
      operationId: addToGroup
      summary: Add member to group
      description: Adds a user to a group
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/conversationId"
      requestBody:
        description: User details
        required: true
        content:
          application/json:
            schema:
              type: object
              description: User object
              properties:
                userId:
                  $ref: "#/components/schemas/Id"
              required:
                - userId
            example:
              userId: "550e8400-e29b-41d4-a716-446655440000"
      security:
        - BearerAuth: []
      responses:
        "201":
          description: User added to group successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
              examples:
                userExample:
                  $ref: "#/components/examples/userExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /groups/{conversationId}/members/me:
    delete:
      operationId: leaveGroup
      summary: Leave group
      description: Removes the authenticated user from a group
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/conversationId"
      security:
        - BearerAuth: []
      responses:
        "204":
          description: User left the group successfully
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /messages/{messageId}:
    parameters:
      - $ref: "#/components/parameters/messageId"
    put:
      operationId: editMessage
      summary: Update message
      description: Update the content of a message
      tags:
        - conversations
      requestBody:
        description: Message details
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Content object
              properties:
                content:
                  $ref: "#/components/schemas/Content"
              required:
                - content
            example:
              content: Hello, how are you?
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Message updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
              examples:
                messageExample:
                  $ref: "#/components/examples/messageExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      operationId: deleteMessage
      summary: Delete message
      description: Permanently deletes a message
      tags:
        - conversations
      security:
        - BearerAuth: []
      responses:
        "204":
          description: Message deleted successfully
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /messages/{messageId}/comments:
    post:
      operationId: commentMessage
      summary: Comment message
      description: Adds a comment to a message
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/messageId"
      requestBody:
        description: Comment details
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Emoji object
              properties:
                emoji:
                  $ref: "#/components/schemas/Emoji"
              required:
                - emoji
            example:
              emoji: "ðŸ˜€"
      security:
        - BearerAuth: []
      responses:
        "201":
          description: Comment added successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Comment"
              examples:
                commentExample:
                  $ref: "#/components/examples/commentExample"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /comments/{commentId}:
    delete:
      operationId: uncommentMessage
      summary: Uncomment message
      description: Permanently deletes a comment from a message
      tags:
        - conversations
      parameters:
        - $ref: "#/components/parameters/commentId"
      security:
        - BearerAuth: []
      responses:
        "204":
          description: Comment deleted successfully
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

components:
  schemas:
    # --------------------------------------------------------------------------------
    # Common

    Id:
      type: string
      format: uuid
      minLength: 36
      maxLength: 36
      pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
      description: Unique identifier

    Timestamp:
      type: string
      format: date-time
      minLength: 20
      maxLength: 20
      description: Timestamp in RFC 3339 format

    Image:
      type: string
      format: binary
      minLength: 1
      maxLength: 4194304
      description: Binary data for image upload

    # --------------------------------------------------------------------------------
    # User

    Username:
      type: string
      minLength: 3
      maxLength: 16
      pattern: "^[a-zA-Z0-9._]{3,16}$"
      description: Unique handle used to identify the user

    ProfilePicture:
      type: string
      minLength: 11
      maxLength: 255
      pattern: "^http://(localhost|127\\.0\\.0\\.1):[0-9]{1,5}/uploads/profile-pictures/(default|[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})\\.(jpg|jpeg|png|gif|webp|bmp|svg)$"
      description: URL of the user's profile picture

    UserPreview:
      type: object
      description: Preview of user details
      properties:
        userId:
          $ref: "#/components/schemas/Id"
        username:
          $ref: "#/components/schemas/Username"
        profilePicture:
          $ref: "#/components/schemas/ProfilePicture"
      required:
        - userId
        - username

    User:
      allOf:
        - $ref: "#/components/schemas/UserPreview"
        - type: object
          description: User details
          properties:
            createdAt:
              $ref: "#/components/schemas/Timestamp"
          required:
            - createdAt

    # --------------------------------------------------------------------------------
    # Conversation

    Type:
      type: string
      enum:
        - private
        - group
      description: Type of conversation (private or group)

    BaseConversation:
      type: object
      description: Base conversation details
      properties:
        conversationId:
          $ref: "#/components/schemas/Id"
        type:
          $ref: "#/components/schemas/Type"
        createdAt:
          $ref: "#/components/schemas/Timestamp"
      required:
        - conversationId
        - type
        - createdAt
      discriminator:
        propertyName: type
        mapping:
          private: "#/components/schemas/PrivateConversation"
          group: "#/components/schemas/GroupConversation"

    PrivateConversation:
      allOf:
        - $ref: "#/components/schemas/BaseConversation"
        - type: object
          description: Private conversation details
          properties:
            participants:
              type: array
              minItems: 2
              maxItems: 2
              description: List of participants in a private conversation
              items:
                $ref: "#/components/schemas/UserPreview"
          required:
            - participants

    Name:
      type: string
      minLength: 1
      maxLength: 50
      pattern: "^.*$"
      description: Group name

    GroupPhoto:
      type: string
      minLength: 11
      maxLength: 255
      pattern: "^http://(localhost|127\\.0\\.0\\.1):[0-9]{1,5}/uploads/group-photos/(default|[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})\\.(jpg|jpeg|png|gif|webp|bmp|svg)$"
      description: URL of the group photo

    GroupConversation:
      allOf:
        - $ref: "#/components/schemas/BaseConversation"
        - type: object
          description: Group conversation details
          properties:
            groupDetails:
              type: object
              description: Group details
              properties:
                name:
                  $ref: "#/components/schemas/Name"
                photo:
                  $ref: "#/components/schemas/GroupPhoto"
              required:
                - name
                - photo
            participants:
              type: array
              minItems: 1
              maxItems: 100
              description: List of group members
              items:
                allOf:
                  - $ref: "#/components/schemas/UserPreview"
                  - type: object
                    description: Participant details
                    properties:
                      joinedAt:
                        $ref: "#/components/schemas/Timestamp"
                    required:
                      - joinedAt
          required:
            - groupDetails
            - participants

    ConversationWithoutMessages:
      oneOf:
        - $ref: "#/components/schemas/PrivateConversation"
        - $ref: "#/components/schemas/GroupConversation"
      discriminator:
        propertyName: type
        mapping:
          private: "#/components/schemas/PrivateConversation"
          group: "#/components/schemas/GroupConversation"

    Conversation:
      allOf:
        - $ref: "#/components/schemas/ConversationWithoutMessages"
        - type: object
          description: List of messages object
          properties:
            messages:
              type: array
              minItems: 0
              maxItems: 1000
              description: List of messages in the conversation
              items:
                $ref: "#/components/schemas/Message"
          required:
            - messages

    # --------------------------------------------------------------------------------
    # Message

    Content:
      type: string
      minLength: 1
      maxLength: 1000
      pattern: "^.*$"
      description: Message content

    Attachment:
      type: string
      minLength: 11
      maxLength: 255
      pattern: "^http://(localhost|127\\.0\\.0\\.1):[0-9]{1,5}/uploads/attachments/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}\\.(jpg|jpeg|png|gif|webp|bmp|svg)$"
      description: URL of the attachment

    Message:
      type: object
      description: Message details
      properties:
        messageId:
          $ref: "#/components/schemas/Id"
        content:
          $ref: "#/components/schemas/Content"
        attachment:
          $ref: "#/components/schemas/Attachment"
        isForwarded:
          type: boolean
          description: Indicates if the message is forwarded
        sender:
          $ref: "#/components/schemas/UserPreview"
        status:
          type: object
          description: Message status
          properties:
            delivered:
              type: object
              description: Delivery status of the message
              additionalProperties:
                $ref: "#/components/schemas/Timestamp"
            read:
              type: object
              description: Read status of the message
              additionalProperties:
                $ref: "#/components/schemas/Timestamp"
          required:
            - delivered
            - read
        comments:
          type: array
          minItems: 0
          maxItems: 100
          description: List of comments on the message
          items:
            $ref: "#/components/schemas/Comment"
        sentAt:
          $ref: "#/components/schemas/Timestamp"
        editedAt:
          $ref: "#/components/schemas/Timestamp"
      required:
        - messageId
        - content
        - isForwarded
        - sender
        - status
        - comments
        - sentAt

    # --------------------------------------------------------------------------------
    # Comment

    Emoji:
      type: string
      minLength: 1
      maxLength: 10
      pattern: "^[\u1F600-\u1F64F\u1F300-\u1F5FF\u1F680-\u1F6FF\u2600-\u26FF\u2700-\u27BF]+$"
      description: Emoji used in the comment

    Comment:
      type: object
      description: Comment details
      properties:
        commentId:
          $ref: "#/components/schemas/Id"
        commenter:
          $ref: "#/components/schemas/UserPreview"
        emoji:
          $ref: "#/components/schemas/Emoji"
        commentedAt:
          $ref: "#/components/schemas/Timestamp"
      required:
        - commentId
        - emoji
        - commentedAt

    # --------------------------------------------------------------------------------
    # Utils

    Error:
      type: object
      description: Error details
      properties:
        code:
          type: string
          minLength: 7
          maxLength: 7
          pattern: "^ERR-[0-9]{3}$"
          description: Machine-readable error code
        message:
          type: string
          minLength: 1
          maxLength: 100
          pattern: "^.*$"
          description: Brief description of the error
      required:
        - code
        - message

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "ERR-400"
            message: Bad request

    Unauthorized:
      description: Unauthorized access
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "ERR-401"
            message: Unauthorized access

    Forbidden:
      description: Forbidden access
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "ERR-403"
            message: Forbidden access

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "ERR-404"
            message: Resource not found

    Conflict:
      description: Conflict error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "ERR-409"
            message: Conflict error

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "ERR-500"
            message: Internal server error

  examples:
    userExample:
      summary: Example user
      value:
        userId: "550e8400-e29b-41d4-a716-446655440000"
        username: Maria
        profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440000.jpg"
        createdAt: "2023-10-01T12:00:00Z"

    conversationExample:
      summary: Example conversation
      value:
        conversationId: "550e8400-e29b-41d4-a716-446655440000"
        type: private
        participants:
          - userId: "550e8400-e29b-41d4-a716-446655440000"
            username: Maria
            profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440000.jpg"
          - userId: "550e8400-e29b-41d4-a716-446655440001"
            username: John
            profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440001.jpg"
        messages: []
        createdAt: "2023-10-01T12:00:00Z"

    groupConversationExample:
      summary: Example group conversation
      value:
        conversationId: "550e8400-e29b-41d4-a716-446655440000"
        type: group
        groupDetails:
          name: Friends Chat
          photo: "http://localhost:8080/uploads/group-photos/550e8400-e29b-41d4-a716-446655440000.jpg"
        participants:
          - userId: "550e8400-e29b-41d4-a716-446655440000"
            username: Maria
            profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440000.jpg"
            joinedAt: "2023-10-01T12:00:00Z"
          - userId: "550e8400-e29b-41d4-a716-446655440001"
            username: John
            profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440001.jpg"
            joinedAt: "2023-10-01T12:00:00Z"
        createdAt: "2023-10-01T12:00:00Z"

    messageExample:
      summary: Example message
      value:
        messageId: "550e8400-e29b-41d4-a716-446655440000"
        content: "Hello, how are you?"
        isForwarded: false
        sender:
          userId: "550e8400-e29b-41d4-a716-446655440000"
          username: Maria
          profilePicture: "http://localhost:8080/uploads/profile-pictures/550e8400-e29b-41d4-a716-446655440000.jpg"
        status:
          delivered:
            "550e8400-e29b-41d4-a716-446655440000": "2023-10-01T12:00:00Z"
          read:
            "550e8400-e29b-41d4-a716-446655440000": "2023-10-01T12:05:00Z"
        comments: []
        sentAt: "2023-10-01T12:00:00Z"

    commentExample:
      summary: Example comment
      value:
        commentId: "550e8400-e29b-41d4-a716-446655440000"
        emoji: "ðŸ˜€"
        commentedAt: "2023-10-01T12:10:00Z"

  parameters:
    userId:
      name: userId
      in: path
      required: true
      description: Unique identifier of the user
      schema:
        $ref: "#/components/schemas/Id"
      example: "550e8400-e29b-41d4-a716-446655440000"

    conversationId:
      name: conversationId
      in: path
      required: true
      description: Unique identifier of the conversation
      schema:
        $ref: "#/components/schemas/Id"
      example: "550e8400-e29b-41d4-a716-446655440000"

    messageId:
      name: messageId
      in: path
      required: true
      description: Unique identifier of the message
      schema:
        $ref: "#/components/schemas/Id"
      example: "550e8400-e29b-41d4-a716-446655440000"

    commentId:
      name: commentId
      in: path
      required: true
      description: Unique identifier of the comment
      schema:
        $ref: "#/components/schemas/Id"
      example: "550e8400-e29b-41d4-a716-446655440000"

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: uuid
